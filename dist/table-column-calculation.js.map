{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 68d21ca1adaa42e4b8c9","webpack:///./src/table-column-calculation.js"],"names":["Calculator","elements","filter","element","some","nonEmptyElements","reduce","ele","total","Math","max","apply","min","sum","length","operator","hasElement","rawValue","Number","toFixed","TableCalculator","$table","on","runCalculation","hasCalculation","renderFoot","tableHeaders","toArray","header","columnHasCalculation","$","$header","data","find","forEach","index","runColumnCalculation","columnIndex","cellValues","getCellValues","calculator","result","run","renderFootCell","map","cell","formattedCellValue","$cell","raw","val","text","trim","append","$tr","each","displayText","init","$tables"],"mappings":"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","file":"table-column-calculation.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"tableColumnCalculation\"] = factory();\n\telse\n\t\troot[\"tableColumnCalculation\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 68d21ca1adaa42e4b8c9","const Calculator = class Calculator {\n  constructor(elements) {\n    this.elements = elements;\n  }\n\n  nonEmptyElements() {\n    return this.elements.filter((element) => element);\n  }\n\n  hasElement() {\n    return this.elements.some((element) => element);\n  }\n\n  sum() {\n    return this.nonEmptyElements().reduce((ele, total) => ele + total);\n  }\n\n  max() {\n    return Math.max.apply(this, this.nonEmptyElements());\n  }\n\n  min() {\n    return Math.min.apply(this, this.nonEmptyElements());\n  }\n\n  avg() {\n    return this.sum() / this.nonEmptyElements().length;\n  }\n\n  run(operator) {\n    if (!this.hasElement()) {\n      return;\n    }\n    let rawValue = this[operator]();\n    if (rawValue) {\n      return Number(rawValue.toFixed(2));\n    }\n  }\n};\n\nconst TableCalculator = class TableCalculator {\n  constructor($table) {\n    this.$table = $table;\n    this.$table.on('change', 'td input', () => this.runCalculation());\n    this.$table.on('recalculation', () => this.runCalculation());\n  }\n\n  init() {\n    if (!this.hasCalculation()) {\n      return;\n    }\n    this.renderFoot();\n    this.runCalculation();\n  }\n\n  hasCalculation() {\n    return this.tableHeaders().toArray().some((header) => this.columnHasCalculation($(header)));\n  }\n\n  columnHasCalculation($header) {\n    return $header.data('operator');\n  }\n\n  tableHeaders() {\n    return this.$table.find('thead th');\n  }\n\n  runCalculation() {\n    this.tableHeaders().toArray().forEach((header, index) => this.runColumnCalculation($(header), index))\n  }\n\n  runColumnCalculation($header, columnIndex) {\n    if (!this.columnHasCalculation($header)) {\n      return;\n    }\n    let cellValues = this.getCellValues(columnIndex);\n    let calculator = new Calculator(cellValues);\n    let operator = $header.data('operator');\n    let result = calculator.run(operator);\n    return this.renderFootCell(columnIndex, operator, result);\n  }\n\n  getCellValues(columnIndex) {\n    return this.$table.find(`tbody tr td:nth-child(${columnIndex + 1})`).toArray().map((cell) => this.formattedCellValue($(cell)))\n  }\n\n  formattedCellValue($cell) {\n    let raw;\n    if ($cell.find('input').length > 0) {\n      raw = $cell.find('input').val();\n    } else {\n      raw = $cell.text().trim();\n    }\n    if (raw) {\n      return +raw;\n    }\n  }\n\n  renderFoot() {\n    this.$table.append($('<tfoot class=\"calculation-foot\"><tr></tr></tfoot>'));\n    let $tr = this.$table.find('tfoot tr');\n    this.tableHeaders().each(() => $tr.append('<th></th>'));\n  }\n\n  renderFootCell(columnIndex, operator, result) {\n    if (!result) {\n      result = '';\n    }\n    let displayText = `${operator}=${result}`;\n    return this.$table.find(`tfoot tr th:nth-child(${columnIndex + 1})`).text(displayText);\n  }\n\n};\n\nexport const init = function($tables) {\n  return $tables.each(function() {\n    let $table = $(this);\n    let calculator = new TableCalculator($table);\n    return calculator.init();\n  });\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/table-column-calculation.js"],"sourceRoot":""}